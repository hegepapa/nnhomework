import csv
import torch
import numpy as np
from torch.utils.data import Dataset, DataLoader


class JarmuDataset(Dataset):
    def __init__(self, csv_name):
        with open(csv_name) as f:
            read_csv = csv.reader(f, delimiter=';')
            header = next(read_csv)
            data = []

            for rows in read_csv:
                v_id = rows[0]
                frame = rows[1]
                x = rows[4]
                y = rows[5]
                v = rows[11]
                a = rows[12]
                line = rows[13]

                data.append([int(v_id), int(frame), float(x), float(y), float(v), float(a), int(line)])

        self.data = torch.from_numpy(np.array(data))
        self.DataNames = header

    def __getitem__(self, index):
        row = self.data[index]
        return row

    def __len__(self):
        return len(self.data)


class Vehicle:
    def __init__(self, id):
        self.id = id


csv_name = "data.csv"
my_data = JarmuDataset(csv_name)
my_loader = DataLoader(dataset=my_data, batch_size=100, shuffle=False)

# print(mydataset.__len__())
# print(mydataset.__getitem__(5))


